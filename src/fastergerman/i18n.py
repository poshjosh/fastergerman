DEFAULT_LANGUAGE_CODE="en"

APP_SHORT_DESCRIPTION="app_short_description"
DISPLAY_QUESTION_TRANSLATION = "display_translation"
GAME_COMPLETED_MESSAGE = "game_completed_message"
GAME_TO_LOAD = "game_to_load"
INVALID = "invalid"
MAX_CONSECUTIVE_CORRECT_ANSWERS = "max_consecutively_correct"
MAX_NUMBER_OF_QUESTIONS = "max_number_of_questions"
NEW_GAME = "new_game"
NO_MORE_QUESTIONS = "no_more_questions"
NOT_FOUND = "not_found"
NUMBER_OF_CHOICES_PER_QUESTION = "number_of_choices"
PAUSE = "pause"
PLEASE_ENTER_NAME = "please_enter_name"
PREPOSITION_TRAINER = "preposition_trainer"
QUESTION_DISPLAY_TIME_SECONDS = "question_display_time"
QUESTIONS_LEFT = "questions_left"
REQUIRED = "required"
SAVE_GAME_AS = "save_game_as"
SCORE = "score"
SELECT_GAME_TO_LOAD = "select_game_to_load"
SETTINGS = "settings"
START = "start"
START_AT_QUESTION_NUMBER = "start_at_question_number"
START_GAME_PROMPT = "start_game_prompt"
SUBMIT = "submit"
TIME = "time"
UNEXPECTED_ERROR = "unexpected_error"

config = {
    DEFAULT_LANGUAGE_CODE: {
        "display_name": "English",
        "dir": "ltr",
        "translations": {
            APP_SHORT_DESCRIPTION: "Learn german faster",
            DISPLAY_QUESTION_TRANSLATION: "Display question translation",
            GAME_COMPLETED_MESSAGE: "Game completed. You scored {} percent.",
            GAME_TO_LOAD: "Game to load",
            INVALID: "Not valid",
            MAX_CONSECUTIVE_CORRECT_ANSWERS: "Max consecutive correct answers",
            MAX_NUMBER_OF_QUESTIONS: "Max number of questions",
            NEW_GAME: "New game",
            NO_MORE_QUESTIONS: "No more questions available from total: {}, for range: {} to {}",
            NOT_FOUND: "Not found",
            NUMBER_OF_CHOICES_PER_QUESTION: "Number of choices per question",
            PAUSE: "Pause",
            PLEASE_ENTER_NAME: "Please enter a name",
            PREPOSITION_TRAINER: "Preposition Trainer",
            QUESTION_DISPLAY_TIME_SECONDS: "Question display time (seconds)",
            QUESTIONS_LEFT: "Questions left",
            REQUIRED: "Required",
            SAVE_GAME_AS: "Save game as",
            SCORE: "Score",
            SELECT_GAME_TO_LOAD: "Select game to load",
            SETTINGS: "Settings",
            START: "Start",
            START_AT_QUESTION_NUMBER: "Start at question number",
            START_GAME_PROMPT: "Click Start to begin",
            SUBMIT: "Submit",
            TIME: "Time",
            UNEXPECTED_ERROR: "Unexpected problem"
        }
    },
    "ar":{
        "display_name": "العربية",
        "dir": "rtl",
        "translations": {
            APP_SHORT_SHORT_DESCRIPTION: "تعلم الألمانية بشكل أسرع",
            DISPLAY_QUESTION_TRANSLATION: "عرض ترجمة السؤال",
            GAME_COMPLETED_MESSAGE: "اكتملت اللعبة. لقد سجلت {} في المائة.",
            GAME_TO_LOAD: "اللعبة قيد التحميل",
            INVALID: "غير صالح",
            MAX_CONSECUTIVE_CORRECT_ANSWERS: "الحد الأقصى للإجابات الصحيحة المتتالية",
            max_number_number_of_questions: "الحد الأقصى لعدد الأسئلة",
            NEW_GAME: "لعبة جديدة",
            NO_MORE_QUESTIONS: "لا مزيد من الأسئلة المتاحة من الإجمالي: {}، للنطاق: {} إلى {}",
            NOT_FOUND: "غير موجود",
            NUMBER_OF_OF_CHOICES_PER_QUESTION: "عدد الاختيارات لكل سؤال",
            PAUSE: "إيقاف مؤقت",
            PLEASE_ENTER_NAME: "الرجاء إدخال اسم",
            PREPOSITION_TRAINER: "مدرب حروف الجر",
            QUESTION_DISPLAY_TIME_SECONDS: "وقت عرض السؤال (بالثواني)",
            QUESTIONS_LEFT: "الأسئلة المتبقية",
            REQUIRED: "مطلوب",
            SAVE_GAME_AS: "حفظ اللعبة باسم",
            SCORE: "النتيجة",
            SELECT_GAME_TO_LOAD: "تحديد_اللعبة المراد تحميلها",
            SETTING: "الإعدادات",
            START: "البدء",
            START_AT_AT_QUESTION_NUMBER: "ابدأ عند رقم السؤال",
            START_GAME_PROMPT: "انقر فوق ابدأ للبدء",
            SUBMIT: "إرسال",
            TIME: "الوقت",
            UNEXPECTECTED_ERROR: "مشكلة غير متوقعة"            
        }
    },
    "bn":{"display_name": "বাংলা"},
    "de":{
        "display_name": "Deutsch",
        "translations": {
            APP_SHORT_DESCRIPTION: "Schneller Deutsch lernen",
            DISPLAY_QUESTION_TRANSLATION: "Frageübersetzung anzeigen",
            GAME_COMPLETED_MESSAGE: "Spiel beendet. Du hast {} Prozent erreicht.",
            GAME_TO_LOAD: "Spiel zu laden",
            INVALID: "Nicht gültig",
            MAX_CONSECUTIVE_CORRECT_ANSWERS: "Max. aufeinanderfolgende richtige Antworten",
            MAX_NUMBER_OF_QUESTIONS: "Maximale Anzahl von Fragen",
            NEW_GAME: "Neues Spiel",
            NO_MORE_QUESTIONS: "Keine weiter Fragen verfügbar von insgesamt: {}, für Bereich: {} bis {}",
            NOT_FOUND: "Nicht gefunden",
            NUMBER_OF_CHOICES_PER_QUESTION: "Anzahl der Auswahlmöglichkeiten pro Frage",
            PAUSE: "Pause",
            PLEASE_ENTER_NAME: "Bitte geben Sie einen Namen ein",
            PREPOSITION_TRAINER: "Präpositionstrainer",
            QUESTION_DISPLAY_TIME_SECONDS: "Frage-Anzeigezeit (Sekunden)",
            QUESTIONS_LEFT: "Verbleibende Fragen",
            REQUIRED: "Erforderlich",
            SAVE_GAME_AS: "Spiel speichern unter",
            SCORE: "Punktestand",
            SELECT_GAME_TO_LOAD: "Spiel zum Laden auswählen",
            SETTINGS: "Einstellungen",
            START: "Start",
            START_AT_QUESTION_NUMBER: "Start bei Fragenummer",
            START_GAME_PROMPT: "Klicken Sie auf Start, um zu beginnen",
            SUBMIT: "Abschicken",
            TIME: "Zeit",
            UNEXPECTED_ERROR: "Unerwartetes Problem"
        }
     },
    "es":{"display_name": "Español"},
    "fr":{"display_name": "Français"},
    "hi":{"display_name": "हिन्दी"},
    "it":{"display_name": "Italiano"},
    "ja":{"display_name": "日本語"},
    "ko":{"display_name": "한국어"},
    "ru":{
        "display_name": "Русский",
        "translations": {
            APP_SHORT_DESCRIPTION: "Учите немецкий быстрее",
            DISPLAY_QUESTION_TRANSLATION: "Отображать перевод вопроса",
            GAME_COMPLETED_MESSAGE: "Игра завершена. Вы набрали {} процентов",
            GAME_TO_LOAD: "Игра должна быть загружена",
            INVALID: "Недействительно",
            MAX_CONSECUTIVE_CORRECT_ANSWERS: "Максимальное количество последовательных правильных ответов",
            MAX_NUMBER_OF_QUESTIONS: "Максимальное количество вопросов",
            NEW_GAME: "Новая игра",
            NO_MORE_QUESTIONS: "Больше нет вопросов из общего количества: {}, для диапазона: {} - {}",
            NOT_FOUND: "Не найдено",
            NUMBER_OF_CHOICES_PER_QUESTION: "Количество вариантов ответа на один вопрос",
            PAUSE: "Пауза",
            PLEASE_ENTER_NAME: "Пожалуйста, введите имя",
            PREPOSITION_TRAINER: "Тренажер по предлогам",
            QUESTION_DISPLAY_TIME_SECONDS: "Время отображения вопроса (секунды)",
            QUESTIONS_LEFT: "Осталось вопросов",
            REQUIRED: "Требуется",
            SAVE_GAME_AS: "Сохранить игру как",
            SCORE: "Оценка",
            SELECT_GAME_TO_LOAD: "Выбрать игру для загрузки",
            SETTINGS: "Настройки",
            START: "Начать",
            START_AT_QUESTION_NUMBER: "Начать с номера вопроса",
            START_GAME_PROMPT: "Нажмите Start, чтобы начать",
            SUBMIT: "Отправить",
            TIME: "Время",
            UNEXPECTED_ERROR: "Неожиданная проблема"
        }
    },
    "tr":{
        "display_name": "Türkçe",
        "translations": {
            APP_SHORT_DESCRIPTION: "Almancayı daha hızlı öğrenin",
            DISPLAY_QUESTION_TRANSLATION: "Soru çevirisini görüntüle",
            GAME_COMPLETED_MESSAGE: "Oyun tamamlandı. Yüzde {} puan aldınız.",
            GAME_TO_LOAD: "Yüklenecek oyun",
            GEÇERSİZ: "Geçerli değil",
            MAX_CONSECUTIVE_CORRECT_ANSWERS: "Maksimum ardışık doğru cevaplar",
            MAX_NUMBER_OF_QUESTIONS: "Maksimum soru sayısı",
            NEW_GAME: "Yeni oyun",
            NO_MORE_QUESTIONS: "Aralık için toplam: {}'dan başka soru yok: {} ila {}",
            NOT_FOUND: "Bulunamadı",
            NUMBER_OF_CHOICES_PER_QUESTION: "Soru başına seçenek sayısı",
            PAUSE: "Duraklat",
            PLEASE_ENTER_NAME: "Lütfen bir isim girin",
            PREPOSITION_TRAINER: "Edat Eğitmeni",
            QUESTION_DISPLAY_TIME_SECONDS: "Soru görüntüleme süresi (saniye)",
            QUESTIONS_LEFT: "Sorular kaldı",
            GEREKLİ: "Gerekli",
            SAVE_GAME_AS: "Oyunu farklı kaydet",
            SKOR: "Skor",
            SELECT_GAME_TO_LOAD: "Yüklenecek oyunu seçin",
            AYARLAR: "Ayarlar",
            START: "Başlat",
            START_AT_QUESTION_NUMBER: "Soru numarasından başla",
            START_GAME_PROMPT: "Başlamak için Başlat'a tıklayın",
            SUBMIT: "Gönder",
            TIME: "Zaman",
            UNEXPECTED_ERROR: "Beklenmeyen sorun"
        }
    },
    "uk":{
        "display_name": "українська",
        "translations": {
            APP_SHORT_DESCRIPTION: "Вивчайте німецьку швидше",
            DISPLAY_QUESTION_TRANSLATION: "Показати переклад запитання",
            GAME_COMPLETED_MESSAGE: "Гру завершено. Ви набрали {} відсотків.",
            GAME_TO_LOAD: "Гру потрібно завантажити",
            INVALID: "Недійсний",
            MAX_CONSECUTIVE_CORRECT_ANSWERS: "Максимальна кількість правильних відповідей підряд",
            MAX_NUMBER_OF_QUESTIONS: "Максимальна кількість запитань",
            NEW_GAME: "Нова гра",
            NO_MORE_QUESTIONS: "Немає більше запитань від total: {}, для діапазону: {} до {}",
            NOT_FOUND: "Не знайдено",
            NUMBER_OF_CHOICES_PER_QUESTION: "Кількість варіантів відповіді на запитання",
            PAUSE: "Пауза",
            PLEASE_ENTER_NAME: "Будь ласка, введіть ім'я",
            PREPOSITION_TRAINER: "Тренер прийменників",
            QUESTION_DISPLAY_TIME_SECONDS: "Час відображення запитання (секунди)",
            QUESTIONS_LEFT: "Залишилося запитань",
            REQUIRED: "Потрібно",
            SAVE_GAME_AS: "Зберегти гру як",
            SCORE: "Оцінка",
            SELECT_GAME_TO_LOAD: "Вибрати гру для завантаження",
            SETTINGS: "Налаштування",
            START: "Старт",
            START_AT_QUESTION_NUMBER: "Почати з номера питання",
            START_GAME_PROMPT: "Натисніть Start, щоб почати",
            SUBMIT: "Надіслати",
            TIME: "Час",
            UNEXPECTED_ERROR: "Неочікувана проблема"
        }
    },
    "zh":{"display_name": "中文"}
}

class I18n:
    @staticmethod
    def is_supported(lang_code: str):
        return I18n.get_config(lang_code).get("translations", None) is not None

    @staticmethod
    def get_supported_language_codes():
        return [e for e in config.keys() if I18n.is_supported(e) is True]

    @staticmethod
    def get_supported_languages():
        supported_languages = []
        for k in I18n.get_supported_language_codes():
            v = config[k]
            supported_languages.append({"code": k, "display_name": v["display_name"]})
        return supported_languages

    @staticmethod
    def get_config(lang: str) -> dict[str, any]:
        lang = str(lang).lower()
        found = config.get(lang, None)
        if found:
            return found
        parts = lang.split('-')
        lang = parts[0] if len(parts) > 1 else DEFAULT_LANGUAGE_CODE
        return config.get(lang, {})

    @staticmethod
    def translate(lang: str, key: str, *args) -> str:
        """
        Translate a key to a language.
        If language code has a sub part e.g. zh-CN fallback to zh, otherwise fallback to DEFAULT_LANG
        :param lang: The language code to translate to.
        :param key: The key to translate.
        :return: The translated string.
        """
        val = I18n.get_config(lang).get("translations", {}).get(key, None)
        if val:
            return str(val).format(*args) if args else val
        elif lang != DEFAULT_LANGUAGE_CODE:
            val = I18n.translate(DEFAULT_LANGUAGE_CODE, key, *args)
            return val if val else key
        else:
            raise ValueError(f"{lang} translation not found for key {key}")

    @staticmethod
    def get_dir(lang) -> str:
        return I18n.get_config(lang).get("dir", "ltr")

    @staticmethod
    def get_translations(lang) -> dict[str, str]:
        translation_keys = I18n.get_config(DEFAULT_LANGUAGE_CODE)["translations"].keys()
        result = {}
        for k in translation_keys:
            result[k] = I18n.translate(lang, k)
        return result

